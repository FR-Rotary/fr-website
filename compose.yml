services:
  php:
    build: 
      context: .
      dockerfile: php.Dockerfile
    networks:
      - nginx-php
      - db-con
    volumes:
      - ./website:/var/www/html
      - ./php.ini:/usr/local/etc/php/php.ini
      - ./db.ini.php:/var/www/html/config/db.ini.php
  nginx:
    image: nginx:1.25.3-alpine
    networks:
      - reverse-proxy
      - nginx-php
    volumes:
      - ./website:/var/www/html
      - ./default.conf:/etc/nginx/conf.d/default.conf
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.fr-rotary.rule=Host(`fr-rotary.com`)||Host(`www.fr-rotary.com`)"
      - "traefik.http.routers.fr-rotary.entrypoints=websecure"

networks:
  reverse-proxy:
    external: true
  db-con:
    external: true
  nginx-php:
